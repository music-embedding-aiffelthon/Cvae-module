
Loading dataset...
Load song_meta.json...
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 773978.53it/s]
7it [00:00, 13.57it/s]
Load complete!







165it [00:14, 11.32it/s]
Load song_meta.json...
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 824036.30it/s]
4it [00:00, 27.54it/s]
Load complete!







165it [00:12, 13.25it/s]
 53%|█████████████████████████████▌                          | 372975/707989 [00:00<00:00, 846111.92it/s]
Load song_meta.json...
Load complete!
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 833109.43it/s]






165it [00:12, 13.21it/s]
Load song_meta.json...
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 815680.82it/s]
13it [00:00, 14.39it/s]
Load complete!






165it [00:12, 13.20it/s]
Load song_meta.json...
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 816520.77it/s]
11it [00:00, 14.70it/s]
Load complete!






165it [00:12, 13.22it/s]
 78%|███████████████████████████████████████████▍            | 549485/707989 [00:00<00:00, 891276.77it/s]
Load song_meta.json...
Load complete!
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 827458.52it/s]






165it [00:12, 13.21it/s]
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 829928.38it/s]
0it [00:00, ?it/s]
Load song_meta.json...
Load complete!







165it [00:12, 13.21it/s]
Load song_meta.json...
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 834638.97it/s]
15it [00:01, 13.61it/s]
Load complete!






165it [00:12, 13.20it/s]
Load song_meta.json...
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 825561.59it/s]
15it [00:01, 13.58it/s]
Load complete!






165it [00:12, 13.19it/s]
100%|████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 828443.78it/s]
0it [00:00, ?it/s]
Load song_meta.json...
Load complete!







165it [00:12, 13.22it/s]
 40%|█████████████████████████████████████▍                                                        | 282018/707989 [00:00<00:00, 937720.74it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 832549.55it/s]






165it [00:12, 13.17it/s]
Load song_meta.json...
Load complete!
Load file list...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 821583.38it/s]






165it [00:12, 13.17it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 833243.38it/s]
4it [00:00, 27.79it/s]
Load complete!







165it [00:12, 13.21it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 833188.91it/s]
7it [00:00, 15.93it/s]
Load complete!






165it [00:12, 13.24it/s]
 26%|████████████████████████▏                                                                     | 182480/707989 [00:00<00:00, 904338.42it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 851819.73it/s]






165it [00:12, 13.16it/s]
 13%|████████████                                                                                   | 89686/707989 [00:00<00:00, 896803.13it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 814069.69it/s]






165it [00:12, 13.23it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 809837.95it/s]
7it [00:00, 16.06it/s]
Load complete!







165it [00:12, 13.20it/s]
 52%|█████████████████████████████████████████████████                                             | 369544/707989 [00:00<00:00, 869158.62it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 848556.06it/s]






165it [00:12, 13.23it/s]
 39%|████████████████████████████████████▏                                                         | 272893/707989 [00:00<00:00, 909588.33it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 823598.40it/s]






165it [00:12, 13.18it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 803719.33it/s]
7it [00:00, 15.63it/s]
Load complete!







165it [00:12, 13.20it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 814992.43it/s]
9it [00:00, 14.96it/s]
Load complete!






165it [00:12, 13.26it/s]
 39%|█████████████████████████████████████▏                                                        | 279631/707989 [00:00<00:00, 933826.36it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 836536.66it/s]






165it [00:12, 13.23it/s]
 38%|████████████████████████████████████                                                          | 271385/707989 [00:00<00:00, 903988.99it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 823165.99it/s]






165it [00:12, 13.19it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 832256.72it/s]
7it [00:00, 15.68it/s]
Load complete!






165it [00:12, 13.22it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████▉          | 632481/707989 [00:00<00:00, 854488.48it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 820258.49it/s]






165it [00:12, 13.29it/s]
 65%|█████████████████████████████████████████████████████████████▎                                | 461879/707989 [00:00<00:00, 877012.05it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 829248.86it/s]






165it [00:12, 13.27it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 834783.03it/s]
13it [00:00, 14.34it/s]
Load complete!






165it [00:12, 13.25it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 825728.94it/s]
15it [00:01, 13.54it/s]
Load complete!






165it [00:12, 13.19it/s]
 78%|█████████████████████████████████████████████████████████████████████████▋                    | 555294/707989 [00:00<00:00, 894896.14it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 834464.47it/s]






165it [00:12, 13.27it/s]
 78%|█████████████████████████████████████████████████████████████████████████▋                    | 555128/707989 [00:00<00:00, 904738.75it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 841757.78it/s]





165it [00:12, 13.22it/s]
Epoch 1:   0%|                                                                                                          | 0/45 [00:00<?, ?it/s]
genre_encoder=0
batch_size = 32
learning rate = 0.0001
train_size = 11610
test_size = 2903











Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:44<00:00,  1.01it/s]












Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.82it/s]











Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.83it/s]











Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.85it/s]











Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.83it/s]
Traceback (most recent call last):
  File "genre_encoder_main.py", line 83, in <module>
    trainer.train_model(train_dataloader, test_dataloader,num_epochs=config['pretrain_epoch'])
  File "/home/anthonypark6904/genre_encoder/train_module.py", line 154, in save_model
    checkpoints.save_checkpoint(ckpt_dir=self.log_dir, target=self.state.params, prefix=f"{index}_{config['latent_size']}", step=self.state.step)
NameError: name 'index' is not defined
Traceback (most recent call last):
  File "genre_encoder_main.py", line 83, in <module>
    trainer.train_model(train_dataloader, test_dataloader,num_epochs=config['pretrain_epoch'])
  File "/home/anthonypark6904/genre_encoder/train_module.py", line 154, in save_model
    checkpoints.save_checkpoint(ckpt_dir=self.log_dir, target=self.state.params, prefix=f"{index}_{config['latent_size']}", step=self.state.step)
NameError: name 'index' is not defined