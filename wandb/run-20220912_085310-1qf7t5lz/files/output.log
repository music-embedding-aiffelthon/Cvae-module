
Loading dataset...
Load song_meta.json...
Load complete!
Load file list...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 789652.63it/s]







165it [00:12, 12.87it/s]
 78%|█████████████████████████████████████████████████████████████████████████▏                    | 551341/707989 [00:00<00:00, 867628.07it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 813068.00it/s]






165it [00:12, 13.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 808979.51it/s]
4it [00:00, 27.32it/s]
Load song_meta.json...
Load complete!







165it [00:12, 13.11it/s]
 13%|████████████                                                                                   | 90189/707989 [00:00<00:00, 901839.26it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 814252.96it/s]






165it [00:12, 13.15it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 800260.30it/s]
9it [00:00, 14.86it/s]
Load complete!






165it [00:12, 13.14it/s]
 39%|████████████████████████████████████▌                                                         | 274937/707989 [00:00<00:00, 910312.35it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 815667.82it/s]






165it [00:12, 13.17it/s]
 39%|████████████████████████████████████▎                                                         | 273098/707989 [00:00<00:00, 871339.03it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 803788.51it/s]






165it [00:12, 13.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 816374.18it/s]
4it [00:00, 27.91it/s]
Load song_meta.json...
Load complete!







165it [00:12, 13.17it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████▋          | 630648/707989 [00:00<00:00, 852331.01it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 811670.12it/s]






165it [00:12, 13.14it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 818218.72it/s]
9it [00:00, 15.26it/s]
Load complete!






165it [00:12, 13.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 819775.03it/s]
0it [00:00, ?it/s]
Load song_meta.json...
Load complete!







165it [00:12, 13.14it/s]
 39%|████████████████████████████████████▌                                                         | 275236/707989 [00:00<00:00, 907225.03it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 826312.79it/s]






165it [00:12, 13.17it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 800158.30it/s]
7it [00:00, 15.85it/s]
Load complete!






165it [00:12, 13.16it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 810478.06it/s]
7it [00:00, 15.78it/s]
Load complete!






165it [00:12, 13.12it/s]
 26%|████████████████████████▎                                                                     | 182666/707989 [00:00<00:00, 877806.29it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 824683.48it/s]






165it [00:12, 13.12it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 822761.39it/s]
15it [00:01, 13.52it/s]
Load complete!






165it [00:12, 13.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 806583.73it/s]
0it [00:00, ?it/s]
Load song_meta.json...
Load complete!







165it [00:12, 13.17it/s]
 13%|████████████▎                                                                                  | 91882/707989 [00:00<00:00, 918763.92it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 826894.47it/s]






165it [00:12, 13.19it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 819840.66it/s]
15it [00:01, 13.69it/s]
Load complete!






165it [00:12, 13.21it/s]
 90%|████████████████████████████████████████████████████████████████████████████████████▌         | 637301/707989 [00:00<00:00, 856287.16it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 817976.65it/s]






165it [00:12, 13.07it/s]
 88%|███████████████████████████████████████████████████████████████████████████████████           | 625887/707989 [00:00<00:00, 846393.95it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 806757.72it/s]






165it [00:12, 13.16it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 816210.60it/s]
9it [00:00, 14.84it/s]
Load complete!






165it [00:12, 13.12it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 825153.94it/s]
4it [00:00, 27.63it/s]
Load song_meta.json...
Load complete!







165it [00:12, 13.17it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 825803.80it/s]
15it [00:01, 13.48it/s]
Load complete!






165it [00:12, 13.11it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 810911.85it/s]
4it [00:00, 28.17it/s]
Load song_meta.json...
Load complete!







165it [00:12, 13.16it/s]
 90%|████████████████████████████████████████████████████████████████████████████████████▊         | 639204/707989 [00:00<00:00, 854072.78it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 819854.92it/s]






165it [00:12, 13.15it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 824842.91it/s]
13it [00:00, 14.33it/s]
Load complete!






165it [00:12, 13.16it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 815062.00it/s]
13it [00:00, 14.23it/s]
Load complete!






165it [00:12, 13.03it/s]
 25%|███████████████████████▊                                                                      | 179332/707989 [00:00<00:00, 888207.88it/s]
Load song_meta.json...
Load complete!
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 821633.84it/s]






165it [00:12, 13.18it/s]
Load song_meta.json...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 707989/707989 [00:00<00:00, 821759.12it/s]
17it [00:01, 13.09it/s]
Load complete!






165it [00:12, 13.16it/s]
genre_encoder=0
batch_size = 32
learning rate = 0.0001
train_size = 11610
test_size = 2903
Data load complete!












Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:44<00:00,  1.01it/s]











Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.85it/s]











Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]












Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:44<00:00,  1.02it/s]











Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.84it/s]












Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.85it/s]











Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.85it/s]











Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.87it/s]











Epoch 5: 100%|███████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 1: 100%|███████████████████████| 45/45 [00:24<00:00,  1.86it/s]












Epoch 2: 100%|███████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 3: 100%|███████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 4: 100%|███████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.87it/s]











Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.87it/s]











Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.86it/s]











Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.87it/s]











Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:24<00:00,  1.87it/s]
Epoch 1:   3%|██▌                                                                                               | 1/39 [00:00<00:20,  1.86it/s]
genre_encoder=1
batch_size = 32
learning rate = 0.0001
train_size = 10133
test_size = 2534









Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:20<00:00,  1.87it/s]










Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:20<00:00,  1.86it/s]









Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:20<00:00,  1.86it/s]










Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:20<00:00,  1.87it/s]









Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:20<00:00,  1.86it/s]










Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:20<00:00,  1.86it/s]









Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:20<00:00,  1.87it/s]










Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:20<00:00,  1.87it/s]



Epoch 4:  44%|██████████████████████████████████████████▎                                                      | 17/39 [00:09<00:12,  1.77it/s]
Traceback (most recent call last):
  File "genre_encoder_main.py", line 83, in <module>
    print('genre_encoder=',index)
  File "/home/anthonypark6904/genre_encoder/train_module.py", line 125, in train_model
    self.train_epoch(epoch_idx, train_dataloader, test_dataloader)
  File "/home/anthonypark6904/genre_encoder/train_module.py", line 140, in train_epoch
    wandb.log({'train_loss': jax.device_get(train_loss.mean()), 'test_loss': jax.device_get(test_loss.mean())})
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/numpy/reductions.py", line 260, in mean
    return _mean(a, _ensure_optional_axes(axis), dtype, out, keepdims,
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/device_array.py", line 265, in __array__
    return np.asarray(self._value, dtype=dtype)
  File "/usr/local/lib/python3.8/dist-packages/jax/interpreters/pxla.py", line 788, in _sda_value
    npy_value[self.indices[i]] = self.device_buffers[i].to_py()
KeyboardInterrupt
Traceback (most recent call last):
  File "genre_encoder_main.py", line 83, in <module>
    print('genre_encoder=',index)
  File "/home/anthonypark6904/genre_encoder/train_module.py", line 125, in train_model
    self.train_epoch(epoch_idx, train_dataloader, test_dataloader)
  File "/home/anthonypark6904/genre_encoder/train_module.py", line 140, in train_epoch
    wandb.log({'train_loss': jax.device_get(train_loss.mean()), 'test_loss': jax.device_get(test_loss.mean())})
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/numpy/reductions.py", line 260, in mean
    return _mean(a, _ensure_optional_axes(axis), dtype, out, keepdims,
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/device_array.py", line 265, in __array__
    return np.asarray(self._value, dtype=dtype)
  File "/usr/local/lib/python3.8/dist-packages/jax/interpreters/pxla.py", line 788, in _sda_value
    npy_value[self.indices[i]] = self.device_buffers[i].to_py()
KeyboardInterrupt